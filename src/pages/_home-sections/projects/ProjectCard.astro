---
import type { Project } from '#/data/projects';
import { Image } from 'astro:assets';
import { ArrowUpRight, Github } from 'lucide-astro';

type Props = Project;

const { title, year, desc, tags, color, image, ...rest } = Astro.props;

const url = 'url' in rest ? rest.url : undefined;
const github = 'github' in rest ? rest.github : undefined;
---

<div
  class="group flex flex-col bg-bg-alt border-2 border-border rounded-xl shadow-[4px_4px_0_var(--color-border)] hover:-translate-x-1 hover:-translate-y-1 hover:shadow-[6px_6px_0_var(--color-border)] transition-all overflow-hidden"
>
  {image ? (
    <div class="h-40 border-b-2 border-border overflow-hidden">
      <Image 
        src={image} 
        alt={title} 
        class="w-full h-full object-cover group-hover:scale-105 transition-transform duration-300"
      />
    </div>
  ) : (
    <div
      class={`h-40 bg-linear-to-br ${color} border-b-2 border-border flex items-center justify-center`}
    >
      <svg
        class="w-12 h-12 text-text-muted/30"
        xmlns="http://www.w3.org/2000/svg"
        fill="none"
        viewBox="0 0 24 24"
        stroke="currentColor"
        stroke-width="1.5"
      >
        <path
          stroke-linecap="round"
          stroke-linejoin="round"
          d="M2.25 15.75l5.159-5.159a2.25 2.25 0 013.182 0l5.159 5.159m-1.5-1.5l1.409-1.409a2.25 2.25 0 013.182 0l2.909 2.909m-18 3.75h16.5a1.5 1.5 0 001.5-1.5V6a1.5 1.5 0 00-1.5-1.5H3.75A1.5 1.5 0 002.25 6v12a1.5 1.5 0 001.5 1.5zm10.5-11.25h.008v.008h-.008V8.25zm.375 0a.375.375 0 11-.75 0 .375.375 0 01.75 0z"
        />
      </svg>
    </div>
  )}
  <div class="p-5 flex flex-col gap-2 flex-1">
    <span class="font-mono text-xs text-text-muted">{year}</span>

    <div class="flex items-center justify-between gap-2">
      <h3 class="text-base font-mono font-bold transition-colors">{title}</h3>
      {(url || github) && (
        <div class="flex items-center gap-1">
          {url && (
            <a
              href={url}
              target="_blank"
              rel="noopener"
              class="p-1.5 text-text-muted hover:text-primary hover:bg-primary/10 rounded-md transition-all group/link"
              aria-label="View project"
            >
              <ArrowUpRight class="size-4 group-hover/link:-translate-y-0.5 transition-transform" />
            </a>
          )}
          {github && (
            <a
              href={github}
              target="_blank"
              rel="noopener"
              class="p-1.5 text-text-muted hover:text-primary hover:bg-primary/10 rounded-md transition-all group/link"
              aria-label="View source code"
            >
              <Github class="size-4 group-hover/link:-translate-y-0.5 transition-transform" />
            </a>
          )}
        </div>
      )}
    </div>
    <p class="text-text-muted text-sm leading-relaxed">{desc}</p>
    <div class="flex gap-2 flex-wrap mt-auto pt-3">
      {tags.map((tag) => (
        <span class="font-mono text-[0.65rem] px-2 py-1 border border-border-light rounded-md uppercase">{tag}</span>
      ))}
    </div>
  </div>
</div>
